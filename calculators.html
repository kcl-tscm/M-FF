

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Calculators &mdash; MFF 0.1.0 documentation</title>
  

  
  
  
  

  
  <script type="text/javascript" src="_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
        <script type="text/javascript" src="_static/jquery.js"></script>
        <script type="text/javascript" src="_static/underscore.js"></script>
        <script type="text/javascript" src="_static/doctools.js"></script>
        <script type="text/javascript" src="_static/language_data.js"></script>
    
    <script type="text/javascript" src="_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="API Reference" href="api.html" />
    <link rel="prev" title="Gaussian Processes" href="gp.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="index.html" class="icon icon-home"> MFF
          

          
            
            <img src="_static/mff_logo_2.svg" class="logo" alt="Logo"/>
          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Table of Contents</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="install.html">Installation</a><ul>
<li class="toctree-l2"><a class="reference internal" href="install.html#requirements">Requirements</a></li>
<li class="toctree-l2"><a class="reference internal" href="install.html#usage">Usage</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="models.html">Models</a><ul>
<li class="toctree-l2"><a class="reference internal" href="models.html#building-a-model">Building a model</a></li>
<li class="toctree-l2"><a class="reference internal" href="models.html#fitting-the-model">Fitting the model</a></li>
<li class="toctree-l2"><a class="reference internal" href="models.html#predicting-forces-and-energies-with-the-gp">Predicting forces and energies with the GP</a></li>
<li class="toctree-l2"><a class="reference internal" href="models.html#building-a-mapped-potential">Building a mapped potential</a></li>
<li class="toctree-l2"><a class="reference internal" href="models.html#saving-and-loading-a-model">Saving and loading a model</a></li>
<li class="toctree-l2"><a class="reference internal" href="models.html#model-s-complete-reference">Model’s complete reference</a></li>
<li class="toctree-l2"><a class="reference internal" href="models.html#two-body-model">Two Body Model</a></li>
<li class="toctree-l2"><a class="reference internal" href="models.html#three-body-model">Three Body Model</a></li>
<li class="toctree-l2"><a class="reference internal" href="models.html#combined-model">Combined Model</a></li>
<li class="toctree-l2"><a class="reference internal" href="models.html#eam-model">Eam Model</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="confs.html">Configurations</a></li>
<li class="toctree-l1"><a class="reference internal" href="gp.html">Gaussian Processes</a><ul>
<li class="toctree-l2"><a class="reference internal" href="gp.html#two-body-kernel">Two Body Kernel</a></li>
<li class="toctree-l2"><a class="reference internal" href="gp.html#three-body-kernel">Three Body Kernel</a></li>
</ul>
</li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Calculators</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#theory-introduction">Theory/Introduction</a></li>
<li class="toctree-l2"><a class="reference internal" href="#example">Example</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="api.html">API Reference</a><ul>
<li class="toctree-l2"><a class="reference internal" href="api.html#the-models-module">The “models” module</a></li>
<li class="toctree-l2"><a class="reference internal" href="api.html#the-gp-module">The “gp” module</a></li>
<li class="toctree-l2"><a class="reference internal" href="api.html#the-configurations-module">The “configurations” module</a></li>
<li class="toctree-l2"><a class="reference internal" href="api.html#the-calculators-module">The “calculators” module</a></li>
<li class="toctree-l2"><a class="reference internal" href="api.html#the-kernels-module">The “kernels” module</a></li>
</ul>
</li>
</ul>
<p class="caption"><span class="caption-text">Appendix</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="genindex.html">Index</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">MFF</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html">Docs</a> &raquo;</li>
        
      <li>Calculators</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="_sources/calculators.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="calculators">
<h1>Calculators<a class="headerlink" href="#calculators" title="Permalink to this headline">¶</a></h1>
<p>A mapped potential is a tabulated 2-, 3-body or eam-like interatomic potential created using Gaussian process regresssion and a 2-, 3-body or eam-like kernel.
To use a mapped potential created with this python package within the ASE environment, it is necessary to setup a calculator using the <code class="docutils literal notranslate"><span class="pre">mff.calculators</span></code> class.</p>
<div class="section" id="theory-introduction">
<h2>Theory/Introduction<a class="headerlink" href="#theory-introduction" title="Permalink to this headline">¶</a></h2>
<p>The <code class="docutils literal notranslate"><span class="pre">model.build_grid()</span></code> function builds a taulated 2- or 3- body potential. The calculator method allows to exploit the ASE functionalities to
run molecular dynamics simulations.
For a 2-body potential, the calculator class computes the energy and force contributions to a central atom for each other atom in its neighbourhood.
These contributions depend only on the interatomic pairwise distance, and are computed trhough 1D spline interpolation of the stored values of the pairwise energy. The magnitude and verse of the pairwise force contributions are computed using the analytic derivitive of this 1D spline, while the direction of the force contribution must be the line that connects the central atom and its neighbour, for symmetry.
When a 3-body potential is used, the local energy and force acting on an atom are a sum of triplet contributions which contain the central atom and two other atoms within a cutoff distance. The triplet energy contributions are computed using a 3D spline interpolation on the stored values of triplet energy which have been calculated using  <code class="docutils literal notranslate"><span class="pre">model.build_grid()</span></code>. The local force contributions are obtained through analytic derivative of the 3D spline interpolation used to calculate triplet energies.
The calculator behaves like a tabulated potential, and its speed scales linearly (2-body) or quadratically (3-body) with the number of atoms within a cutoff distance, and is completely independent of the number of training points used for the Gaussian process regression.
The force field obtained is also analytically energy conserving, since the force is the opposite of the analytic derivative of the local energy.</p>
<p>WARNING: The atoms in the <code class="docutils literal notranslate"><span class="pre">atoms</span></code> object must be ordered in increasing atomic number for the calculator to work correctly.
To do so, simply run the following line of code on the <code class="docutils literal notranslate"><span class="pre">atoms</span></code> object before the calculator is assigned:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">atoms</span> <span class="o">=</span> <span class="n">atoms</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">argsort</span><span class="p">(</span><span class="n">atoms</span><span class="o">.</span><span class="n">get_atomic_numbers</span><span class="p">())]</span>
</pre></div>
</div>
</div>
<div class="section" id="example">
<h2>Example<a class="headerlink" href="#example" title="Permalink to this headline">¶</a></h2>
<p>Assuming we already trained a model named <code class="docutils literal notranslate"><span class="pre">model</span></code> and built the relative mapped force field, we can assign an ASE calculator based on such force field to an ASE atoms object.</p>
<p>For a 2-body single species model:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">mff.calculators</span> <span class="k">import</span> <span class="n">TwoBodySingleSpecies</span>
<span class="n">calc</span> <span class="o">=</span> <span class="n">TwoBodySingleSpecies</span><span class="p">(</span><span class="n">r_cut</span><span class="p">,</span> <span class="n">model</span><span class="o">.</span><span class="n">grid</span><span class="p">)</span>
<span class="n">atoms</span> <span class="o">=</span> <span class="n">atoms</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">argsort</span><span class="p">(</span><span class="n">atoms</span><span class="o">.</span><span class="n">get_atomic_numbers</span><span class="p">())]</span>
<span class="n">atoms</span><span class="o">.</span><span class="n">set_calculator</span><span class="p">(</span><span class="n">calc</span><span class="p">)</span>
</pre></div>
</div>
<p>For a 3-body model:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">mff.calculators</span> <span class="k">import</span> <span class="n">ThreeBodySingleSpecies</span>
<span class="n">calc</span> <span class="o">=</span> <span class="n">ThreeBodySingleSpecies</span><span class="p">(</span><span class="n">r_cut</span><span class="p">,</span> <span class="n">model</span><span class="o">.</span><span class="n">grid</span><span class="p">)</span>
<span class="n">atoms</span> <span class="o">=</span> <span class="n">atoms</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">argsort</span><span class="p">(</span><span class="n">atoms</span><span class="o">.</span><span class="n">get_atomic_numbers</span><span class="p">())]</span>
<span class="n">atoms</span><span class="o">.</span><span class="n">set_calculator</span><span class="p">(</span><span class="n">calc</span><span class="p">)</span>
</pre></div>
</div>
<p>For a combined (2+3-body) model:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">mff.calculators</span> <span class="k">import</span> <span class="n">CombinedSingleSpecies</span>
<span class="n">calc</span> <span class="o">=</span> <span class="n">CombinedSingleSpecies</span><span class="p">(</span><span class="n">r_cut</span><span class="p">,</span> <span class="n">model</span><span class="o">.</span><span class="n">grid_2b</span><span class="p">,</span> <span class="n">model</span><span class="o">.</span><span class="n">grid_3b</span><span class="p">)</span>
<span class="n">atoms</span> <span class="o">=</span> <span class="n">atoms</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">argsort</span><span class="p">(</span><span class="n">atoms</span><span class="o">.</span><span class="n">get_atomic_numbers</span><span class="p">())]</span>
<span class="n">atoms</span><span class="o">.</span><span class="n">set_calculator</span><span class="p">(</span><span class="n">calc</span><span class="p">)</span>
</pre></div>
</div>
<dl class="class">
<dt>
<em class="property">class </em><code class="sig-prename descclassname">mff.calculators.</code><code class="sig-name descname">CombinedManySpecies</code><span class="sig-paren">(</span><em class="sig-param">r_cut</em>, <em class="sig-param">elements</em>, <em class="sig-param">grids_2b</em>, <em class="sig-param">grids_3b</em>, <em class="sig-param">**kwargs</em><span class="sig-paren">)</span></dt>
<dd></dd></dl>

<dl class="class">
<dt>
<em class="property">class </em><code class="sig-prename descclassname">mff.calculators.</code><code class="sig-name descname">CombinedSingleSpecies</code><span class="sig-paren">(</span><em class="sig-param">r_cut</em>, <em class="sig-param">grid_2b</em>, <em class="sig-param">grid_3b</em>, <em class="sig-param">**kwargs</em><span class="sig-paren">)</span></dt>
<dd></dd></dl>

<dl class="class">
<dt>
<em class="property">class </em><code class="sig-prename descclassname">mff.calculators.</code><code class="sig-name descname">EamManySpecies</code><span class="sig-paren">(</span><em class="sig-param">r_cut</em>, <em class="sig-param">elements</em>, <em class="sig-param">grids_eam</em>, <em class="sig-param">alpha</em>, <em class="sig-param">r0</em>, <em class="sig-param">**kwargs</em><span class="sig-paren">)</span></dt>
<dd><p>A mapped Eam calculator for ase</p>
<dl class="attribute">
<dt id="mff.calculators.EamManySpecies.grid_eam">
<code class="sig-name descname">grid_eam</code><a class="headerlink" href="#mff.calculators.EamManySpecies.grid_eam" title="Permalink to this definition">¶</a></dt>
<dd><p>list of 1D Spline interpolator, one for each element in elements</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>object</p>
</dd>
</dl>
</dd></dl>

<dl class="attribute">
<dt id="mff.calculators.EamManySpecies.results">
<code class="sig-name descname">results</code><a class="headerlink" href="#mff.calculators.EamManySpecies.results" title="Permalink to this definition">¶</a></dt>
<dd><p>energy and forces calculated on the atoms object</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>dict</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt>
<code class="sig-name descname">calculate</code><span class="sig-paren">(</span><em class="sig-param">atoms=None, properties=('energy', 'forces'), system_changes=['positions', 'numbers', 'cell', 'pbc', 'initial_charges', 'initial_magmoms']</em><span class="sig-paren">)</span></dt>
<dd><p>Do the calculation.</p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt>
<em class="property">class </em><code class="sig-prename descclassname">mff.calculators.</code><code class="sig-name descname">EamSingleSpecies</code><span class="sig-paren">(</span><em class="sig-param">r_cut</em>, <em class="sig-param">grid_eam</em>, <em class="sig-param">alpha</em>, <em class="sig-param">r0</em>, <em class="sig-param">**kwargs</em><span class="sig-paren">)</span></dt>
<dd><p>A mapped Eam calculator for ase</p>
<dl class="attribute">
<dt id="mff.calculators.EamSingleSpecies.grid_eam">
<code class="sig-name descname">grid_eam</code><a class="headerlink" href="#mff.calculators.EamSingleSpecies.grid_eam" title="Permalink to this definition">¶</a></dt>
<dd><p>1D Spline interpolator for the eam mapped grid</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>object</p>
</dd>
</dl>
</dd></dl>

<dl class="attribute">
<dt id="mff.calculators.EamSingleSpecies.results">
<code class="sig-name descname">results</code><a class="headerlink" href="#mff.calculators.EamSingleSpecies.results" title="Permalink to this definition">¶</a></dt>
<dd><p>energy and forces calculated on the atoms object</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>dict</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt>
<code class="sig-name descname">calculate</code><span class="sig-paren">(</span><em class="sig-param">atoms=None, properties=('energy', 'forces'), system_changes=['positions', 'numbers', 'cell', 'pbc', 'initial_charges', 'initial_magmoms']</em><span class="sig-paren">)</span></dt>
<dd><p>Do the calculation.</p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt>
<em class="property">class </em><code class="sig-prename descclassname">mff.calculators.</code><code class="sig-name descname">ManySpeciesMappedPotential</code><span class="sig-paren">(</span><em class="sig-param">r_cut</em>, <em class="sig-param">elements</em>, <em class="sig-param">**kwargs</em><span class="sig-paren">)</span></dt>
<dd><dl class="method">
<dt>
<code class="sig-name descname">calculate</code><span class="sig-paren">(</span><em class="sig-param">atoms=None, properties=('energy', 'forces'), system_changes=['positions', 'numbers', 'cell', 'pbc', 'initial_charges', 'initial_magmoms']</em><span class="sig-paren">)</span></dt>
<dd><p>Do the calculation.</p>
<dl class="simple">
<dt>properties: list of str</dt><dd><p>List of what needs to be calculated.  Can be any combination
of ‘energy’, ‘forces’, ‘stress’, ‘dipole’, ‘charges’, ‘magmom’
and ‘magmoms’.</p>
</dd>
<dt>system_changes: list of str</dt><dd><p>List of what has changed since last calculation.  Can be
any combination of these six: ‘positions’, ‘numbers’, ‘cell’,
‘pbc’, ‘initial_charges’ and ‘initial_magmoms’.</p>
</dd>
</dl>
<p>Subclasses need to implement this, but can ignore properties
and system_changes if they want.  Calculated properties should
be inserted into results dictionary like shown in this dummy
example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="bp">self</span><span class="o">.</span><span class="n">results</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;energy&#39;</span><span class="p">:</span> <span class="mf">0.0</span><span class="p">,</span>
                <span class="s1">&#39;forces&#39;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="nb">len</span><span class="p">(</span><span class="n">atoms</span><span class="p">),</span> <span class="mi">3</span><span class="p">)),</span>
                <span class="s1">&#39;stress&#39;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="mi">6</span><span class="p">),</span>
                <span class="s1">&#39;dipole&#39;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span>
                <span class="s1">&#39;charges&#39;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">atoms</span><span class="p">)),</span>
                <span class="s1">&#39;magmom&#39;</span><span class="p">:</span> <span class="mf">0.0</span><span class="p">,</span>
                <span class="s1">&#39;magmoms&#39;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">atoms</span><span class="p">))}</span>
</pre></div>
</div>
<p>The subclass implementation should first call this
implementation to set the atoms attribute.</p>
</dd></dl>

<dl class="method">
<dt>
<code class="sig-name descname">set</code><span class="sig-paren">(</span><em class="sig-param">**kwargs</em><span class="sig-paren">)</span></dt>
<dd><p>Set parameters like set(key1=value1, key2=value2, …).</p>
<p>A dictionary containing the parameters that have been changed
is returned.</p>
<p>Subclasses must implement a set() method that will look at the
chaneged parameters and decide if a call to reset() is needed.
If the changed parameters are harmless, like a change in
verbosity, then there is no need to call reset().</p>
<p>The special keyword ‘parameters’ can be used to read
parameters from a file.</p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt>
<em class="property">class </em><code class="sig-prename descclassname">mff.calculators.</code><code class="sig-name descname">MappedPotential</code><span class="sig-paren">(</span><em class="sig-param">r_cut</em>, <em class="sig-param">**kwargs</em><span class="sig-paren">)</span></dt>
<dd><dl class="method">
<dt>
<code class="sig-name descname">calculate</code><span class="sig-paren">(</span><em class="sig-param">atoms=None, properties=('energy', 'forces'), system_changes=['positions', 'numbers', 'cell', 'pbc', 'initial_charges', 'initial_magmoms']</em><span class="sig-paren">)</span></dt>
<dd><p>Do the calculation.</p>
<dl class="simple">
<dt>properties: list of str</dt><dd><p>List of what needs to be calculated.  Can be any combination
of ‘energy’, ‘forces’, ‘stress’, ‘dipole’, ‘charges’, ‘magmom’
and ‘magmoms’.</p>
</dd>
<dt>system_changes: list of str</dt><dd><p>List of what has changed since last calculation.  Can be
any combination of these six: ‘positions’, ‘numbers’, ‘cell’,
‘pbc’, ‘initial_charges’ and ‘initial_magmoms’.</p>
</dd>
</dl>
<p>Subclasses need to implement this, but can ignore properties
and system_changes if they want.  Calculated properties should
be inserted into results dictionary like shown in this dummy
example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="bp">self</span><span class="o">.</span><span class="n">results</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;energy&#39;</span><span class="p">:</span> <span class="mf">0.0</span><span class="p">,</span>
                <span class="s1">&#39;forces&#39;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="nb">len</span><span class="p">(</span><span class="n">atoms</span><span class="p">),</span> <span class="mi">3</span><span class="p">)),</span>
                <span class="s1">&#39;stress&#39;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="mi">6</span><span class="p">),</span>
                <span class="s1">&#39;dipole&#39;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span>
                <span class="s1">&#39;charges&#39;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">atoms</span><span class="p">)),</span>
                <span class="s1">&#39;magmom&#39;</span><span class="p">:</span> <span class="mf">0.0</span><span class="p">,</span>
                <span class="s1">&#39;magmoms&#39;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">atoms</span><span class="p">))}</span>
</pre></div>
</div>
<p>The subclass implementation should first call this
implementation to set the atoms attribute.</p>
</dd></dl>

<dl class="method">
<dt>
<code class="sig-name descname">set</code><span class="sig-paren">(</span><em class="sig-param">**kwargs</em><span class="sig-paren">)</span></dt>
<dd><p>Set parameters like set(key1=value1, key2=value2, …).</p>
<p>A dictionary containing the parameters that have been changed
is returned.</p>
<p>Subclasses must implement a set() method that will look at the
chaneged parameters and decide if a call to reset() is needed.
If the changed parameters are harmless, like a change in
verbosity, then there is no need to call reset().</p>
<p>The special keyword ‘parameters’ can be used to read
parameters from a file.</p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt>
<em class="property">class </em><code class="sig-prename descclassname">mff.calculators.</code><code class="sig-name descname">ThreeBodyManySpecies</code><span class="sig-paren">(</span><em class="sig-param">r_cut</em>, <em class="sig-param">elements</em>, <em class="sig-param">grids_3b</em>, <em class="sig-param">**kwargs</em><span class="sig-paren">)</span></dt>
<dd><p>A mapped 3-body 2-species calculator for ase</p>
<dl class="attribute">
<dt id="mff.calculators.ThreeBodyManySpecies.elements">
<code class="sig-name descname">elements</code><a class="headerlink" href="#mff.calculators.ThreeBodyManySpecies.elements" title="Permalink to this definition">¶</a></dt>
<dd><p>List of ordered atomic numbers of the mapped two species system.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>list</p>
</dd>
</dl>
</dd></dl>

<dl class="attribute">
<dt id="mff.calculators.ThreeBodyManySpecies.grids_3b">
<code class="sig-name descname">grids_3b</code><a class="headerlink" href="#mff.calculators.ThreeBodyManySpecies.grids_3b" title="Permalink to this definition">¶</a></dt>
<dd><p>contains the four 3D Spline interpolators relative to the 3-body
mapped grids for element0-element0-element0, element0-element0-element1,
element0-element1-element1 and element1-element1-element1 interactions.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>dict</p>
</dd>
</dl>
</dd></dl>

<dl class="attribute">
<dt id="mff.calculators.ThreeBodyManySpecies.results">
<code class="sig-name descname">results</code><a class="headerlink" href="#mff.calculators.ThreeBodyManySpecies.results" title="Permalink to this definition">¶</a></dt>
<dd><p>energy and forces calculated on the atoms object</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>dict</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt>
<code class="sig-name descname">calculate</code><span class="sig-paren">(</span><em class="sig-param">atoms=None, properties=('energy', 'forces'), system_changes=['positions', 'numbers', 'cell', 'pbc', 'initial_charges', 'initial_magmoms']</em><span class="sig-paren">)</span></dt>
<dd><p>Do the calculation.</p>
</dd></dl>

<dl class="method">
<dt>
<code class="sig-name descname">find_triplets</code><span class="sig-paren">(</span><em class="sig-param">atoms</em><span class="sig-paren">)</span></dt>
<dd><p>Function that efficiently finds all of the valid triplets of atoms in the atoms object.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p><dl class="simple">
<dt>array containing the indices of atoms belonging to any valid triplet.</dt><dd><p>Has shape T by 3 where T is the number of valid triplets in the atoms object</p>
</dd>
<dt>distances (array): array containing the relative distances of every triplet of atoms.</dt><dd><p>Has shape T by 3 where T is the number of valid triplets in the atoms object</p>
</dd>
<dt>positions (dictionary): versor of position w.r.t. the central atom of every atom indexed in indices.</dt><dd><p>Has shape T by 3 where T is the number of valid triplets in the atoms object</p>
</dd>
</dl>
</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>indices (array)</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="class">
<dt>
<em class="property">class </em><code class="sig-prename descclassname">mff.calculators.</code><code class="sig-name descname">ThreeBodySingleSpecies</code><span class="sig-paren">(</span><em class="sig-param">r_cut</em>, <em class="sig-param">grid_3b</em>, <em class="sig-param">**kwargs</em><span class="sig-paren">)</span></dt>
<dd><p>A mapped 3-body calculator for ase</p>
<dl class="attribute">
<dt id="mff.calculators.ThreeBodySingleSpecies.grid_3b">
<code class="sig-name descname">grid_3b</code><a class="headerlink" href="#mff.calculators.ThreeBodySingleSpecies.grid_3b" title="Permalink to this definition">¶</a></dt>
<dd><p>3D Spline interpolator for the 3-body mapped grid</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>object</p>
</dd>
</dl>
</dd></dl>

<dl class="attribute">
<dt id="mff.calculators.ThreeBodySingleSpecies.results">
<code class="sig-name descname">results</code><a class="headerlink" href="#mff.calculators.ThreeBodySingleSpecies.results" title="Permalink to this definition">¶</a></dt>
<dd><p>energy and forces calculated on the atoms object</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>dict</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt>
<code class="sig-name descname">calculate</code><span class="sig-paren">(</span><em class="sig-param">atoms=None, properties=('energy', 'forces'), system_changes=['positions', 'numbers', 'cell', 'pbc', 'initial_charges', 'initial_magmoms']</em><span class="sig-paren">)</span></dt>
<dd><p>Do the calculation.</p>
</dd></dl>

<dl class="method">
<dt>
<code class="sig-name descname">find_triplets</code><span class="sig-paren">(</span><span class="sig-paren">)</span></dt>
<dd><p>Function that efficiently finds all of the valid triplets of atoms in the atoms object.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p><dl class="simple">
<dt>array containing the indices of atoms belonging to any valid triplet.</dt><dd><p>Has shape T by 3 where T is the number of valid triplets in the atoms object</p>
</dd>
<dt>distances (array): array containing the relative distances of every triplet of atoms.</dt><dd><p>Has shape T by 3 where T is the number of valid triplets in the atoms object</p>
</dd>
<dt>positions (dictionary): versor of position w.r.t. the central atom of every atom indexed in indices.</dt><dd><p>Has shape T by 3 where T is the number of valid triplets in the atoms object</p>
</dd>
</dl>
</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>indices (array)</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="class">
<dt>
<em class="property">class </em><code class="sig-prename descclassname">mff.calculators.</code><code class="sig-name descname">TwoBodyManySpecies</code><span class="sig-paren">(</span><em class="sig-param">r_cut</em>, <em class="sig-param">elements</em>, <em class="sig-param">grids_2b</em>, <em class="sig-param">**kwargs</em><span class="sig-paren">)</span></dt>
<dd><p>A mapped 2-body 2-species calculator for ase</p>
<dl class="attribute">
<dt id="mff.calculators.TwoBodyManySpecies.elements">
<code class="sig-name descname">elements</code><a class="headerlink" href="#mff.calculators.TwoBodyManySpecies.elements" title="Permalink to this definition">¶</a></dt>
<dd><p>List of ordered atomic numbers of the mapped two species system.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>list</p>
</dd>
</dl>
</dd></dl>

<dl class="attribute">
<dt id="mff.calculators.TwoBodyManySpecies.grids_2b">
<code class="sig-name descname">grids_2b</code><a class="headerlink" href="#mff.calculators.TwoBodyManySpecies.grids_2b" title="Permalink to this definition">¶</a></dt>
<dd><p>contains the three 1D Spline interpolators relative to the 2-body
mapped grids for element0-element0, element0-element1 and element1-element1 interactions</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>dict</p>
</dd>
</dl>
</dd></dl>

<dl class="attribute">
<dt id="mff.calculators.TwoBodyManySpecies.results">
<code class="sig-name descname">results</code><a class="headerlink" href="#mff.calculators.TwoBodyManySpecies.results" title="Permalink to this definition">¶</a></dt>
<dd><p>energy and forces calculated on the atoms object</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>dict</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt>
<code class="sig-name descname">calculate</code><span class="sig-paren">(</span><em class="sig-param">atoms=None, properties=('energy', 'forces'), system_changes=['positions', 'numbers', 'cell', 'pbc', 'initial_charges', 'initial_magmoms']</em><span class="sig-paren">)</span></dt>
<dd><p>Do the calculation.</p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt>
<em class="property">class </em><code class="sig-prename descclassname">mff.calculators.</code><code class="sig-name descname">TwoBodySingleSpecies</code><span class="sig-paren">(</span><em class="sig-param">r_cut</em>, <em class="sig-param">grid_2b</em>, <em class="sig-param">**kwargs</em><span class="sig-paren">)</span></dt>
<dd><p>A mapped 2-body calculator for ase</p>
<dl class="attribute">
<dt id="mff.calculators.TwoBodySingleSpecies.grid_2b">
<code class="sig-name descname">grid_2b</code><a class="headerlink" href="#mff.calculators.TwoBodySingleSpecies.grid_2b" title="Permalink to this definition">¶</a></dt>
<dd><p>1D Spline interpolator for the 2-body mapped grid</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>object</p>
</dd>
</dl>
</dd></dl>

<dl class="attribute">
<dt id="mff.calculators.TwoBodySingleSpecies.results">
<code class="sig-name descname">results</code><a class="headerlink" href="#mff.calculators.TwoBodySingleSpecies.results" title="Permalink to this definition">¶</a></dt>
<dd><p>energy and forces calculated on the atoms object</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>dict</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt>
<code class="sig-name descname">calculate</code><span class="sig-paren">(</span><em class="sig-param">atoms=None, properties=('energy', 'forces'), system_changes=['positions', 'numbers', 'cell', 'pbc', 'initial_charges', 'initial_magmoms']</em><span class="sig-paren">)</span></dt>
<dd><p>Do the calculation.</p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt>
<em class="property">class </em><code class="sig-prename descclassname">mff.calculators.</code><code class="sig-name descname">TwoThreeEamManySpecies</code><span class="sig-paren">(</span><em class="sig-param">r_cut</em>, <em class="sig-param">elements</em>, <em class="sig-param">grids_2b</em>, <em class="sig-param">grids_3b</em>, <em class="sig-param">grids_eam</em>, <em class="sig-param">alpha</em>, <em class="sig-param">r0</em>, <em class="sig-param">**kwargs</em><span class="sig-paren">)</span></dt>
<dd></dd></dl>

<dl class="class">
<dt>
<em class="property">class </em><code class="sig-prename descclassname">mff.calculators.</code><code class="sig-name descname">TwoThreeEamSingleSpecies</code><span class="sig-paren">(</span><em class="sig-param">r_cut</em>, <em class="sig-param">grid_2b</em>, <em class="sig-param">grid_3b</em>, <em class="sig-param">grid_eam</em>, <em class="sig-param">alpha</em>, <em class="sig-param">r0</em>, <em class="sig-param">**kwargs</em><span class="sig-paren">)</span></dt>
<dd></dd></dl>

<dl class="function">
<dt>
<code class="sig-prename descclassname">mff.calculators.</code><code class="sig-name descname">eam_descriptor</code><span class="sig-paren">(</span><em class="sig-param">dist</em>, <em class="sig-param">norm</em>, <em class="sig-param">rc</em>, <em class="sig-param">alpha</em>, <em class="sig-param">r0</em><span class="sig-paren">)</span></dt>
<dd><p>Function used to return the eam descriptor for an atom given
the descriptor’s hyperparameters and the set of distances of neighbours.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>dist</strong> (<em>array</em>) – Array of distances of neighbours</p></li>
<li><p><strong>norm</strong> (<em>array</em>) – Array of versors of neighbours</p></li>
<li><p><strong>rc</strong> (<em>float</em>) – cutoff radius</p></li>
<li><p><strong>alpha</strong> (<em>float</em>) – exponent prefactor of the descriptor</p></li>
<li><p><strong>r0</strong> (<em>float</em>) – radius in the descriptor</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Eam descriptor</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>t2 (float)</p>
</dd>
</dl>
</dd></dl>

</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="api.html" class="btn btn-neutral float-right" title="API Reference" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="gp.html" class="btn btn-neutral float-left" title="Gaussian Processes" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>

    </p>
  </div> 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>