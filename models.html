

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Models &mdash; MFF 0.1.0 documentation</title>
  

  
  
  
  

  
  <script type="text/javascript" src="_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
        <script type="text/javascript" src="_static/jquery.js"></script>
        <script type="text/javascript" src="_static/underscore.js"></script>
        <script type="text/javascript" src="_static/doctools.js"></script>
        <script type="text/javascript" src="_static/language_data.js"></script>
    
    <script type="text/javascript" src="_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Configurations" href="confs.html" />
    <link rel="prev" title="Installation" href="install.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="index.html" class="icon icon-home"> MFF
          

          
            
            <img src="_static/mff_logo_2.svg" class="logo" alt="Logo"/>
          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Table of Contents</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="install.html">Installation</a><ul>
<li class="toctree-l2"><a class="reference internal" href="install.html#requirements">Requirements</a></li>
<li class="toctree-l2"><a class="reference internal" href="install.html#usage">Usage</a></li>
</ul>
</li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Models</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#building-a-model">Building a model</a></li>
<li class="toctree-l2"><a class="reference internal" href="#fitting-the-model">Fitting the model</a></li>
<li class="toctree-l2"><a class="reference internal" href="#predicting-forces-and-energies-with-the-gp">Predicting forces and energies with the GP</a></li>
<li class="toctree-l2"><a class="reference internal" href="#building-a-mapped-potential">Building a mapped potential</a></li>
<li class="toctree-l2"><a class="reference internal" href="#saving-and-loading-a-model">Saving and loading a model</a></li>
<li class="toctree-l2"><a class="reference internal" href="#model-s-complete-reference">Model’s complete reference</a></li>
<li class="toctree-l2"><a class="reference internal" href="#two-body-model">Two Body Model</a></li>
<li class="toctree-l2"><a class="reference internal" href="#three-body-model">Three Body Model</a></li>
<li class="toctree-l2"><a class="reference internal" href="#combined-model">Combined Model</a></li>
<li class="toctree-l2"><a class="reference internal" href="#eam-model">Eam Model</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="confs.html">Configurations</a></li>
<li class="toctree-l1"><a class="reference internal" href="gp.html">Gaussian Processes</a><ul>
<li class="toctree-l2"><a class="reference internal" href="gp.html#two-body-kernel">Two Body Kernel</a></li>
<li class="toctree-l2"><a class="reference internal" href="gp.html#three-body-kernel">Three Body Kernel</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="calculators.html">Calculators</a><ul>
<li class="toctree-l2"><a class="reference internal" href="calculators.html#theory-introduction">Theory/Introduction</a></li>
<li class="toctree-l2"><a class="reference internal" href="calculators.html#example">Example</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="api.html">API Reference</a><ul>
<li class="toctree-l2"><a class="reference internal" href="api.html#the-models-module">The “models” module</a></li>
<li class="toctree-l2"><a class="reference internal" href="api.html#the-gp-module">The “gp” module</a></li>
<li class="toctree-l2"><a class="reference internal" href="api.html#the-configurations-module">The “configurations” module</a></li>
<li class="toctree-l2"><a class="reference internal" href="api.html#the-calculators-module">The “calculators” module</a></li>
<li class="toctree-l2"><a class="reference internal" href="api.html#the-kernels-module">The “kernels” module</a></li>
</ul>
</li>
</ul>
<p class="caption"><span class="caption-text">Appendix</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="genindex.html">Index</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">MFF</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html">Docs</a> &raquo;</li>
        
      <li>Models</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="_sources/models.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="models">
<h1>Models<a class="headerlink" href="#models" title="Permalink to this headline">¶</a></h1>
<p>The models are the classes used to build, train and test a Gaussian process, and to then build the relative mapped potential.
There are six types of models at the moment, each one is used to handle 2-, 3-, or 2+3-body kernels in the case of one or two atomic species.
When creating a model, it is therefore necessary to decide a priori the type of Gaussian process and, therefore, the type of mapped potential we want to obtain.</p>
<div class="section" id="building-a-model">
<h2>Building a model<a class="headerlink" href="#building-a-model" title="Permalink to this headline">¶</a></h2>
<p>To create a model based on a 2-body kernel for a monoatomic system:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">mff</span> <span class="k">import</span> <span class="n">models</span>
<span class="n">mymodel</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">TwoBodySingleSpecies</span><span class="p">(</span><span class="n">atomic_number</span><span class="p">,</span> <span class="n">cutoff_radius</span><span class="p">,</span> <span class="n">sigma</span><span class="p">,</span> <span class="n">theta</span><span class="p">,</span> <span class="n">noise</span><span class="p">)</span>
</pre></div>
</div>
<p>where the parameters refer to the atomic number of the species we are training the GP on, the cutoff radius we want to use, the lengthscale hyperparameter of the Gaussian Process, the hyperparameter governing the exponential decay of the cutoff function, and the noise associated with the output training data.
In the case of a 2+3-body kernel for a monoatomic system:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">mff</span> <span class="k">import</span> <span class="n">models</span>
<span class="n">mymodel</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">CombinedSingleSpecies</span><span class="p">(</span><span class="n">atomic_number</span><span class="p">,</span> <span class="n">cutoff_radius</span><span class="p">,</span> <span class="n">sigma_2b</span><span class="p">,</span> <span class="n">theta_2b</span><span class="p">,</span> <span class="n">sigma_3b</span><span class="p">,</span> <span class="n">theta_3b</span><span class="p">,</span> <span class="n">noise</span><span class="p">)</span>
</pre></div>
</div>
<p>where we have two additional hyperparameters since the lengthscale value and the cutoff decay ratio of the 2- and 3-body kernels contained inside the combined Gaussian Process are be independent.</p>
<p>When dealing with a two-element system, the syntax is very similar, but the <code class="docutils literal notranslate"><span class="pre">atomic_number</span></code> is instead a list containing the atomic numbers of the two species, in increasing order:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">mff</span> <span class="k">import</span> <span class="n">models</span>
<span class="n">mymodel</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">CombinedTwoSpecies</span><span class="p">(</span><span class="n">atomic_numbers</span><span class="p">,</span> <span class="n">cutoff_radius</span><span class="p">,</span> <span class="n">sigma_2b</span><span class="p">,</span> <span class="n">theta_2b</span><span class="p">,</span> <span class="n">sigma_3b</span><span class="p">,</span> <span class="n">theta_3b</span><span class="p">,</span> <span class="n">noise</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="fitting-the-model">
<h2>Fitting the model<a class="headerlink" href="#fitting-the-model" title="Permalink to this headline">¶</a></h2>
<p>Once a model has been built, we can train it using a dataset of forces, energies, or energies and forces, that has been created using the <code class="docutils literal notranslate"><span class="pre">configurations</span></code> module. If we are training only on forces:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">mymodel</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">training_confs</span><span class="p">,</span> <span class="n">training_forces</span><span class="p">)</span>
</pre></div>
</div>
<p>training only on energies:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">mymodel</span><span class="o">.</span><span class="n">fit_energy</span><span class="p">(</span><span class="n">training_confs</span><span class="p">,</span> <span class="n">training_energies</span><span class="p">)</span>
</pre></div>
</div>
<p>training on both forces and energies:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">mymodel</span><span class="o">.</span><span class="n">fit_force_and_energy</span><span class="p">(</span><span class="n">training_confs</span><span class="p">,</span> <span class="n">training_forces</span><span class="p">,</span> <span class="n">training_energies</span><span class="p">)</span>
</pre></div>
</div>
<p>Additionaly, the argument <code class="docutils literal notranslate"><span class="pre">ncores</span></code> can be passed to any fit function in order to run the process on multiple processors:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">mymodel</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">training_confs</span><span class="p">,</span> <span class="n">training_forces</span><span class="p">,</span> <span class="n">ncores</span> <span class="o">=</span> <span class="mi">4</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="predicting-forces-and-energies-with-the-gp">
<h2>Predicting forces and energies with the GP<a class="headerlink" href="#predicting-forces-and-energies-with-the-gp" title="Permalink to this headline">¶</a></h2>
<p>Once the Gaussian process has been fitted, it can be used to directly predict forces and energies on test configurations. To predict the force and the energy for a single test configuration:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">force</span> <span class="o">=</span> <span class="n">mymodel</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">test_configuration</span><span class="p">,</span> <span class="n">ncores</span><span class="p">)</span>
<span class="n">energy</span> <span class="o">=</span> <span class="n">mymodel</span><span class="o">.</span><span class="n">predict_energy</span><span class="p">(</span><span class="n">test_configuration</span><span class="p">,</span> <span class="n">ncores</span><span class="p">)</span>
</pre></div>
</div>
<p>the boolean variable <code class="docutils literal notranslate"><span class="pre">return_std</span></code> can be passed to the force and energy predict functions in order to obtain also the standard deviation associated with the prediction, default is False:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">mean_force</span><span class="p">,</span> <span class="n">std_force</span> <span class="o">=</span> <span class="n">mymodel</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">test_configuration</span><span class="p">,</span> <span class="n">return_std</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
<p>Additionaly, the argument <code class="docutils literal notranslate"><span class="pre">ncores</span></code> can be passed to any predict function in order to run the process on multiple processors:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">force</span> <span class="o">=</span> <span class="n">mymodel</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">test_configuration</span><span class="p">,</span> <span class="n">ncores</span> <span class="o">=</span> <span class="mi">4</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="building-a-mapped-potential">
<span id="model-map"></span><h2>Building a mapped potential<a class="headerlink" href="#building-a-mapped-potential" title="Permalink to this headline">¶</a></h2>
<p>Once the Gaussian process has been fitted, either via force, energy or joint force/energy fit, it can be mapped onto a non-parametric 2- and/or 3-body potential using the <code class="docutils literal notranslate"><span class="pre">build_grid</span></code> function. The <code class="docutils literal notranslate"><span class="pre">build_grid</span></code> function takes as arguments the minimum grid distance (smallest distance between atoms for which the potential will be defined), the number of grid points to use while building the 2-body mapped potential, and the number of points per dimension to use while building the 3-body mapped potential.
For a 2-body model:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">mymodel</span><span class="o">.</span><span class="n">build_grid</span><span class="p">(</span><span class="n">grid</span> <span class="n">start</span><span class="p">,</span> <span class="n">num_2b</span><span class="p">)</span>
</pre></div>
</div>
<p>For a 3-body model:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">mymodel</span><span class="o">.</span><span class="n">build_grid</span><span class="p">(</span><span class="n">grid</span> <span class="n">start</span><span class="p">,</span> <span class="n">num_3b</span><span class="p">)</span>
</pre></div>
</div>
<p>For a combined model:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">mymodel</span><span class="o">.</span><span class="n">build_grid</span><span class="p">(</span><span class="n">grid</span> <span class="n">start</span><span class="p">,</span> <span class="n">num_2b</span><span class="p">,</span> <span class="n">num_3b</span><span class="p">)</span>
</pre></div>
</div>
<p>Additionaly, the argument <code class="docutils literal notranslate"><span class="pre">ncores</span></code> can be passed to the <code class="docutils literal notranslate"><span class="pre">build_grid</span></code> function for any model in order to run the process on multiple processors:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">mymodel</span><span class="o">.</span><span class="n">build_grid</span><span class="p">(</span><span class="n">grid</span> <span class="n">start</span><span class="p">,</span> <span class="n">num_2b</span><span class="p">,</span> <span class="n">num_3b</span><span class="p">,</span> <span class="n">ncores</span>  <span class="o">=</span> <span class="mi">4</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="saving-and-loading-a-model">
<h2>Saving and loading a model<a class="headerlink" href="#saving-and-loading-a-model" title="Permalink to this headline">¶</a></h2>
<p>At any stage, a model can be saved using the <code class="docutils literal notranslate"><span class="pre">save</span></code> function that takes a .json filename as the only input:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">mymodel</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="s2">&quot;thismodel.json&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>the save function will create a .json file containing all of the parameters and hyperparameters of the model, and the paths to the .npy and .npz files containing, respectively, the saved GPs and the saved mapped potentials, which are also created by the save funtion.</p>
<p>To load a previously saved model of a known type (here for example a CombinedSingleSpecies model) simply run:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">mymodel</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">CombinedSingleSpecies</span><span class="o">.</span><span class="n">from_json</span><span class="p">(</span><span class="s2">&quot;thismodel.json&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="model-s-complete-reference">
<h2>Model’s complete reference<a class="headerlink" href="#model-s-complete-reference" title="Permalink to this headline">¶</a></h2>
</div>
<div class="section" id="two-body-model">
<h2>Two Body Model<a class="headerlink" href="#two-body-model" title="Permalink to this headline">¶</a></h2>
<p>Module containing the TwoBodySingleSpecies and
TwoBodyTwoSpecies classes, which are used to handle
the Gaussian process and the mapping algorithm used to build M-FFs.
The model has to be first defined, then the Gaussian process must be
trained using training configurations and forces (and/or energies).
Once a model has been trained, it can be used to predict forces
(and/or energies) on unknonwn atomic configurations.
A trained Gaussian process can then be mapped onto a tabulated 2-body
potential via the <code class="docutils literal notranslate"><span class="pre">build</span> <span class="pre">grid</span></code> function call. A mapped model can be then
saved, loaded and used to run molecular dynamics simulations via the
calculator module.
These mapped potentials retain the accuracy of the GP used to build them,
while speeding up the calculations by a factor of 10^4 in typical scenarios.</p>
<p>Example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">mff</span> <span class="k">import</span> <span class="n">models</span>
<span class="n">mymodel</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">TwoBodySingleSpecies</span><span class="p">(</span><span class="n">atomic_number</span><span class="p">,</span> <span class="n">cutoff_radius</span><span class="p">,</span> <span class="n">sigma</span><span class="p">,</span> <span class="n">theta</span><span class="p">,</span> <span class="n">noise</span><span class="p">)</span>
<span class="n">mymodel</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">training_confs</span><span class="p">,</span> <span class="n">training_forces</span><span class="p">,</span> <span class="n">ncores</span><span class="p">)</span>

<span class="n">forces</span> <span class="o">=</span> <span class="n">mymodel</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">test_configurations</span><span class="p">,</span> <span class="n">ncores</span><span class="p">)</span>

<span class="n">mymodel</span><span class="o">.</span><span class="n">build_grid</span><span class="p">(</span><span class="n">grid_start</span><span class="p">,</span> <span class="n">num_2b</span><span class="p">,</span> <span class="n">ncores</span><span class="p">)</span>
<span class="n">mymodel</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="s2">&quot;thismodel.json&quot;</span><span class="p">)</span>

<span class="n">mymodel</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">TwoBodySingleSpecies</span><span class="o">.</span><span class="n">from_json</span><span class="p">(</span><span class="s2">&quot;thismodel.json&quot;</span><span class="p">)</span>
</pre></div>
</div>
<span class="target" id="module-mff.models.twobody"></span><dl class="class">
<dt id="mff.models.twobody.NpEncoder">
<em class="property">class </em><code class="sig-prename descclassname">mff.models.twobody.</code><code class="sig-name descname">NpEncoder</code><span class="sig-paren">(</span><em class="sig-param">*</em>, <em class="sig-param">skipkeys=False</em>, <em class="sig-param">ensure_ascii=True</em>, <em class="sig-param">check_circular=True</em>, <em class="sig-param">allow_nan=True</em>, <em class="sig-param">sort_keys=False</em>, <em class="sig-param">indent=None</em>, <em class="sig-param">separators=None</em>, <em class="sig-param">default=None</em><span class="sig-paren">)</span><a class="headerlink" href="#mff.models.twobody.NpEncoder" title="Permalink to this definition">¶</a></dt>
<dd><dl class="method">
<dt id="mff.models.twobody.NpEncoder.default">
<code class="sig-name descname">default</code><span class="sig-paren">(</span><em class="sig-param">obj</em><span class="sig-paren">)</span><a class="headerlink" href="#mff.models.twobody.NpEncoder.default" title="Permalink to this definition">¶</a></dt>
<dd><p>Implement this method in a subclass such that it returns
a serializable object for <code class="docutils literal notranslate"><span class="pre">o</span></code>, or calls the base implementation
(to raise a <code class="docutils literal notranslate"><span class="pre">TypeError</span></code>).</p>
<p>For example, to support arbitrary iterators, you could
implement default like this:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">default</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">o</span><span class="p">):</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">iterable</span> <span class="o">=</span> <span class="nb">iter</span><span class="p">(</span><span class="n">o</span><span class="p">)</span>
    <span class="k">except</span> <span class="ne">TypeError</span><span class="p">:</span>
        <span class="k">pass</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="nb">list</span><span class="p">(</span><span class="n">iterable</span><span class="p">)</span>
    <span class="c1"># Let the base class default method raise the TypeError</span>
    <span class="k">return</span> <span class="n">JSONEncoder</span><span class="o">.</span><span class="n">default</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">o</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="mff.models.twobody.TwoBodyManySpeciesModel">
<em class="property">class </em><code class="sig-prename descclassname">mff.models.twobody.</code><code class="sig-name descname">TwoBodyManySpeciesModel</code><span class="sig-paren">(</span><em class="sig-param">elements</em>, <em class="sig-param">r_cut</em>, <em class="sig-param">sigma</em>, <em class="sig-param">theta</em>, <em class="sig-param">noise</em>, <em class="sig-param">rep_sig=1</em>, <em class="sig-param">**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#mff.models.twobody.TwoBodyManySpeciesModel" title="Permalink to this definition">¶</a></dt>
<dd><p>2-body many species model class
Class managing the Gaussian process and its mapped counterpart</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>elements</strong> (<em>list</em>) – List containing the atomic numbers in increasing order</p></li>
<li><p><strong>r_cut</strong> (<em>foat</em>) – The cutoff radius used to carve the atomic environments</p></li>
<li><p><strong>sigma</strong> (<em>foat</em>) – Lengthscale parameter of the Gaussian process</p></li>
<li><p><strong>theta</strong> (<em>float</em>) – decay ratio of the cutoff function in the Gaussian Process</p></li>
<li><p><strong>noise</strong> (<em>float</em>) – noise value associated with the training output data</p></li>
</ul>
</dd>
</dl>
<dl class="attribute">
<dt id="mff.models.twobody.TwoBodyManySpeciesModel.gp">
<code class="sig-name descname">gp</code><a class="headerlink" href="#mff.models.twobody.TwoBodyManySpeciesModel.gp" title="Permalink to this definition">¶</a></dt>
<dd><p>The 2-body two species Gaussian Process</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>class</p>
</dd>
</dl>
</dd></dl>

<dl class="attribute">
<dt id="mff.models.twobody.TwoBodyManySpeciesModel.grid">
<code class="sig-name descname">grid</code><a class="headerlink" href="#mff.models.twobody.TwoBodyManySpeciesModel.grid" title="Permalink to this definition">¶</a></dt>
<dd><p>Contains the three 2-body two species tabulated potentials, accounting for
interactions between two atoms of types 0-0, 0-1, and 1-1.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>list</p>
</dd>
</dl>
</dd></dl>

<dl class="attribute">
<dt id="mff.models.twobody.TwoBodyManySpeciesModel.grid_start">
<code class="sig-name descname">grid_start</code><a class="headerlink" href="#mff.models.twobody.TwoBodyManySpeciesModel.grid_start" title="Permalink to this definition">¶</a></dt>
<dd><p>Minimum atomic distance for which the grid is defined (cannot be 0)</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="attribute">
<dt id="mff.models.twobody.TwoBodyManySpeciesModel.grid_num">
<code class="sig-name descname">grid_num</code><a class="headerlink" href="#mff.models.twobody.TwoBodyManySpeciesModel.grid_num" title="Permalink to this definition">¶</a></dt>
<dd><p>number of points used to create the 2-body grids</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>int</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="mff.models.twobody.TwoBodyManySpeciesModel.build_grid">
<code class="sig-name descname">build_grid</code><span class="sig-paren">(</span><em class="sig-param">start</em>, <em class="sig-param">num</em>, <em class="sig-param">ncores=1</em><span class="sig-paren">)</span><a class="headerlink" href="#mff.models.twobody.TwoBodyManySpeciesModel.build_grid" title="Permalink to this definition">¶</a></dt>
<dd><p>Build the mapped 2-body potential.
Calculates the energy predicted by the GP for two atoms at distances that range from
start to r_cut, for a total of num points. These energies are stored and a 1D spline
interpolation is created, which can be used to predict the energy and, through its
analytic derivative, the force associated to any couple of atoms.
The total force or local energy can then be calculated for any atom by summing the
pairwise contributions of every other atom within a cutoff distance r_cut.
Three distinct potentials are built for interactions between atoms of type 0 and 0,
type 0 and 1, and type 1 and 1.
The prediction is done by the <code class="docutils literal notranslate"><span class="pre">calculator</span></code> module which is built to work within
the ase python package.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>start</strong> (<em>float</em>) – smallest interatomic distance for which the energy is predicted
by the GP and stored inn the 2-body mapped potential</p></li>
<li><p><strong>num</strong> (<em>int</em>) – number of points to use in the grid of the mapped potential</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="mff.models.twobody.TwoBodyManySpeciesModel.fit">
<code class="sig-name descname">fit</code><span class="sig-paren">(</span><em class="sig-param">confs</em>, <em class="sig-param">forces</em>, <em class="sig-param">ncores=1</em><span class="sig-paren">)</span><a class="headerlink" href="#mff.models.twobody.TwoBodyManySpeciesModel.fit" title="Permalink to this definition">¶</a></dt>
<dd><p>Fit the GP to a set of training forces using a
2-body single species force-force kernel</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>confs</strong> (<em>list</em>) – List of M x 5 arrays containing coordinates and
atomic numbers of atoms within a cutoff from the central one</p></li>
<li><p><strong>forces</strong> (<em>array</em>) – Array containing the vector forces on
the central atoms of the training configurations</p></li>
<li><p><strong>ncores</strong> (<em>int</em>) – number of CPUs to use for the gram matrix evaluation</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="mff.models.twobody.TwoBodyManySpeciesModel.fit_energy">
<code class="sig-name descname">fit_energy</code><span class="sig-paren">(</span><em class="sig-param">glob_confs</em>, <em class="sig-param">energies</em>, <em class="sig-param">ncores=1</em><span class="sig-paren">)</span><a class="headerlink" href="#mff.models.twobody.TwoBodyManySpeciesModel.fit_energy" title="Permalink to this definition">¶</a></dt>
<dd><p>Fit the GP to a set of training energies using a
2-body single species energy-energy kernel</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>glob_confs</strong> (<em>list of lists</em>) – List of configurations arranged so that
grouped configurations belong to the same snapshot</p></li>
<li><p><strong>energies</strong> (<em>array</em>) – Array containing the total energy of each snapshot</p></li>
<li><p><strong>ncores</strong> (<em>int</em>) – number of CPUs to use for the gram matrix evaluation</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="mff.models.twobody.TwoBodyManySpeciesModel.fit_force_and_energy">
<code class="sig-name descname">fit_force_and_energy</code><span class="sig-paren">(</span><em class="sig-param">confs</em>, <em class="sig-param">forces</em>, <em class="sig-param">glob_confs</em>, <em class="sig-param">energies</em>, <em class="sig-param">ncores=1</em><span class="sig-paren">)</span><a class="headerlink" href="#mff.models.twobody.TwoBodyManySpeciesModel.fit_force_and_energy" title="Permalink to this definition">¶</a></dt>
<dd><p>Fit the GP to a set of training forces and energies using
2-body single species force-force, energy-force and energy-energy kernels</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>confs</strong> (<em>list</em>) – List of M x 5 arrays containing coordinates and
atomic numbers of atoms within a cutoff from the central one</p></li>
<li><p><strong>forces</strong> (<em>array</em>) – Array containing the vector forces on
the central atoms of the training configurations</p></li>
<li><p><strong>glob_confs</strong> (<em>list of lists</em>) – List of configurations arranged so that
grouped configurations belong to the same snapshot</p></li>
<li><p><strong>energies</strong> (<em>array</em>) – Array containing the total energy of each snapshot</p></li>
<li><p><strong>ncores</strong> (<em>int</em>) – number of CPUs to use for the gram matrix evaluation</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="mff.models.twobody.TwoBodyManySpeciesModel.from_json">
<em class="property">classmethod </em><code class="sig-name descname">from_json</code><span class="sig-paren">(</span><em class="sig-param">path</em><span class="sig-paren">)</span><a class="headerlink" href="#mff.models.twobody.TwoBodyManySpeciesModel.from_json" title="Permalink to this definition">¶</a></dt>
<dd><p>Load the models.
Loads the model, the associated GP and the mapped potential, if available.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>path</strong> (<em>str</em>) – path to the .json model file</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>the model object</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>model (obj)</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="mff.models.twobody.TwoBodyManySpeciesModel.load_gp">
<code class="sig-name descname">load_gp</code><span class="sig-paren">(</span><em class="sig-param">filename</em><span class="sig-paren">)</span><a class="headerlink" href="#mff.models.twobody.TwoBodyManySpeciesModel.load_gp" title="Permalink to this definition">¶</a></dt>
<dd><p>Loads the GP object, now obsolete</p>
</dd></dl>

<dl class="method">
<dt id="mff.models.twobody.TwoBodyManySpeciesModel.predict">
<code class="sig-name descname">predict</code><span class="sig-paren">(</span><em class="sig-param">confs</em>, <em class="sig-param">return_std=False</em>, <em class="sig-param">ncores=1</em><span class="sig-paren">)</span><a class="headerlink" href="#mff.models.twobody.TwoBodyManySpeciesModel.predict" title="Permalink to this definition">¶</a></dt>
<dd><p>Predict the forces acting on the central atoms of confs using a GP</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>confs</strong> (<em>list</em>) – List of M x 5 arrays containing coordinates and
atomic numbers of atoms within a cutoff from the central one</p></li>
<li><p><strong>return_std</strong> (<em>bool</em>) – if True, returns the standard deviation
associated to predictions according to the GP framework</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><p>array of force vectors predicted by the GP
forces_errors (array): errors associated to the force predictions,</p>
<blockquote>
<div><p>returned only if return_std is True</p>
</div></blockquote>
</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>forces (array)</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="mff.models.twobody.TwoBodyManySpeciesModel.predict_energy">
<code class="sig-name descname">predict_energy</code><span class="sig-paren">(</span><em class="sig-param">glob_confs</em>, <em class="sig-param">return_std=False</em>, <em class="sig-param">ncores=1</em><span class="sig-paren">)</span><a class="headerlink" href="#mff.models.twobody.TwoBodyManySpeciesModel.predict_energy" title="Permalink to this definition">¶</a></dt>
<dd><p>Predict the global energies of the central atoms of confs using a GP</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>glob_confs</strong> (<em>list of lists</em>) – List of configurations arranged so that
grouped configurations belong to the same snapshot</p></li>
<li><p><strong>return_std</strong> (<em>bool</em>) – if True, returns the standard deviation
associated to predictions according to the GP framework</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><p>Array containing the total energy of each snapshot
energies_errors (array): errors associated to the energies predictions,</p>
<blockquote>
<div><p>returned only if return_std is True</p>
</div></blockquote>
</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>energies (array)</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="mff.models.twobody.TwoBodyManySpeciesModel.save">
<code class="sig-name descname">save</code><span class="sig-paren">(</span><em class="sig-param">path</em><span class="sig-paren">)</span><a class="headerlink" href="#mff.models.twobody.TwoBodyManySpeciesModel.save" title="Permalink to this definition">¶</a></dt>
<dd><p>Save the model.
This creates a .json file containing the parameters of the model and the
paths to the GP objects and the mapped potentials, which are saved as
separate .gpy and .gpz files, respectively.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>path</strong> (<em>str</em>) – path to the file</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="mff.models.twobody.TwoBodyManySpeciesModel.save_gp">
<code class="sig-name descname">save_gp</code><span class="sig-paren">(</span><em class="sig-param">filename</em><span class="sig-paren">)</span><a class="headerlink" href="#mff.models.twobody.TwoBodyManySpeciesModel.save_gp" title="Permalink to this definition">¶</a></dt>
<dd><p>Saves the GP object, now obsolete</p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="mff.models.twobody.TwoBodySingleSpeciesModel">
<em class="property">class </em><code class="sig-prename descclassname">mff.models.twobody.</code><code class="sig-name descname">TwoBodySingleSpeciesModel</code><span class="sig-paren">(</span><em class="sig-param">element</em>, <em class="sig-param">r_cut</em>, <em class="sig-param">sigma</em>, <em class="sig-param">theta</em>, <em class="sig-param">noise</em>, <em class="sig-param">rep_sig=1</em>, <em class="sig-param">**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#mff.models.twobody.TwoBodySingleSpeciesModel" title="Permalink to this definition">¶</a></dt>
<dd><p>2-body single species model class
Class managing the Gaussian process and its mapped counterpart</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>element</strong> (<em>int</em>) – The atomic number of the element considered</p></li>
<li><p><strong>r_cut</strong> (<em>foat</em>) – The cutoff radius used to carve the atomic environments</p></li>
<li><p><strong>sigma</strong> (<em>foat</em>) – Lengthscale parameter of the Gaussian process</p></li>
<li><p><strong>theta</strong> (<em>float</em>) – decay ratio of the cutoff function in the Gaussian Process</p></li>
<li><p><strong>noise</strong> (<em>float</em>) – noise value associated with the training output data</p></li>
</ul>
</dd>
</dl>
<dl class="attribute">
<dt id="mff.models.twobody.TwoBodySingleSpeciesModel.gp">
<code class="sig-name descname">gp</code><a class="headerlink" href="#mff.models.twobody.TwoBodySingleSpeciesModel.gp" title="Permalink to this definition">¶</a></dt>
<dd><p>The 2-body single species Gaussian Process</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>method</p>
</dd>
</dl>
</dd></dl>

<dl class="attribute">
<dt id="mff.models.twobody.TwoBodySingleSpeciesModel.grid">
<code class="sig-name descname">grid</code><a class="headerlink" href="#mff.models.twobody.TwoBodySingleSpeciesModel.grid" title="Permalink to this definition">¶</a></dt>
<dd><p>The 2-body single species tabulated potential</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>method</p>
</dd>
</dl>
</dd></dl>

<dl class="attribute">
<dt id="mff.models.twobody.TwoBodySingleSpeciesModel.grid_start">
<code class="sig-name descname">grid_start</code><a class="headerlink" href="#mff.models.twobody.TwoBodySingleSpeciesModel.grid_start" title="Permalink to this definition">¶</a></dt>
<dd><p>Minimum atomic distance for which the grid is defined (cannot be 0.0)</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="attribute">
<dt id="mff.models.twobody.TwoBodySingleSpeciesModel.grid_num">
<code class="sig-name descname">grid_num</code><a class="headerlink" href="#mff.models.twobody.TwoBodySingleSpeciesModel.grid_num" title="Permalink to this definition">¶</a></dt>
<dd><p>number of points used to create the 2-body grid</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>int</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="mff.models.twobody.TwoBodySingleSpeciesModel.build_grid">
<code class="sig-name descname">build_grid</code><span class="sig-paren">(</span><em class="sig-param">start</em>, <em class="sig-param">num</em>, <em class="sig-param">ncores=1</em><span class="sig-paren">)</span><a class="headerlink" href="#mff.models.twobody.TwoBodySingleSpeciesModel.build_grid" title="Permalink to this definition">¶</a></dt>
<dd><p>Build the mapped 2-body potential.
Calculates the energy predicted by the GP for two atoms at distances that range from
start to r_cut, for a total of num points. These energies are stored and a 1D spline
interpolation is created, which can be used to predict the energy and, through its
analytic derivative, the force associated to any couple of atoms.
The total force or local energy can then be calculated for any atom by summing the
pairwise contributions of every other atom within a cutoff distance r_cut.
The prediction is done by the <code class="docutils literal notranslate"><span class="pre">calculator</span></code> module which is built to work within
the ase python package.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>start</strong> (<em>float</em>) – smallest interatomic distance for which the energy is predicted
by the GP and stored inn the 2-body mapped potential</p></li>
<li><p><strong>num</strong> (<em>int</em>) – number of points to use in the grid of the mapped potential</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="mff.models.twobody.TwoBodySingleSpeciesModel.fit">
<code class="sig-name descname">fit</code><span class="sig-paren">(</span><em class="sig-param">confs</em>, <em class="sig-param">forces</em>, <em class="sig-param">ncores=1</em><span class="sig-paren">)</span><a class="headerlink" href="#mff.models.twobody.TwoBodySingleSpeciesModel.fit" title="Permalink to this definition">¶</a></dt>
<dd><p>Fit the GP to a set of training forces using a
2-body single species force-force kernel</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>confs</strong> (<em>list</em>) – List of M x 5 arrays containing coordinates and
atomic numbers of atoms within a cutoff from the central one</p></li>
<li><p><strong>forces</strong> (<em>array</em>) – Array containing the vector forces on
the central atoms of the training configurations</p></li>
<li><p><strong>ncores</strong> (<em>int</em>) – number of CPUs to use for the gram matrix evaluation</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="mff.models.twobody.TwoBodySingleSpeciesModel.fit_energy">
<code class="sig-name descname">fit_energy</code><span class="sig-paren">(</span><em class="sig-param">glob_confs</em>, <em class="sig-param">energies</em>, <em class="sig-param">ncores=1</em><span class="sig-paren">)</span><a class="headerlink" href="#mff.models.twobody.TwoBodySingleSpeciesModel.fit_energy" title="Permalink to this definition">¶</a></dt>
<dd><p>Fit the GP to a set of training energies using a
2-body single species energy-energy kernel</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>glob_confs</strong> (<em>list of lists</em>) – List of configurations arranged so that
grouped configurations belong to the same snapshot</p></li>
<li><p><strong>energies</strong> (<em>array</em>) – Array containing the total energy of each snapshot</p></li>
<li><p><strong>ncores</strong> (<em>int</em>) – number of CPUs to use for the gram matrix evaluation</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="mff.models.twobody.TwoBodySingleSpeciesModel.fit_force_and_energy">
<code class="sig-name descname">fit_force_and_energy</code><span class="sig-paren">(</span><em class="sig-param">confs</em>, <em class="sig-param">forces</em>, <em class="sig-param">glob_confs</em>, <em class="sig-param">energies</em>, <em class="sig-param">ncores=1</em><span class="sig-paren">)</span><a class="headerlink" href="#mff.models.twobody.TwoBodySingleSpeciesModel.fit_force_and_energy" title="Permalink to this definition">¶</a></dt>
<dd><p>Fit the GP to a set of training forces and energies using
2-body single species force-force, energy-force and energy-energy kernels</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>confs</strong> (<em>list</em>) – List of M x 5 arrays containing coordinates and
atomic numbers of atoms within a cutoff from the central one</p></li>
<li><p><strong>forces</strong> (<em>array</em>) – Array containing the vector forces on
the central atoms of the training configurations</p></li>
<li><p><strong>glob_confs</strong> (<em>list of lists</em>) – List of configurations arranged so that
grouped configurations belong to the same snapshot</p></li>
<li><p><strong>energies</strong> (<em>array</em>) – Array containing the total energy of each snapshot</p></li>
<li><p><strong>ncores</strong> (<em>int</em>) – number of CPUs to use for the gram matrix evaluation</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="mff.models.twobody.TwoBodySingleSpeciesModel.from_json">
<em class="property">classmethod </em><code class="sig-name descname">from_json</code><span class="sig-paren">(</span><em class="sig-param">path</em><span class="sig-paren">)</span><a class="headerlink" href="#mff.models.twobody.TwoBodySingleSpeciesModel.from_json" title="Permalink to this definition">¶</a></dt>
<dd><p>Load the model.
Loads the model, the associated GP and the mapped potential, if available.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>path</strong> (<em>str</em>) – path to the .json model file</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>the model object</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>model (obj)</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="mff.models.twobody.TwoBodySingleSpeciesModel.load_gp">
<code class="sig-name descname">load_gp</code><span class="sig-paren">(</span><em class="sig-param">filename</em><span class="sig-paren">)</span><a class="headerlink" href="#mff.models.twobody.TwoBodySingleSpeciesModel.load_gp" title="Permalink to this definition">¶</a></dt>
<dd><p>Loads the GP object, now obsolete</p>
</dd></dl>

<dl class="method">
<dt id="mff.models.twobody.TwoBodySingleSpeciesModel.predict">
<code class="sig-name descname">predict</code><span class="sig-paren">(</span><em class="sig-param">confs</em>, <em class="sig-param">return_std=False</em>, <em class="sig-param">ncores=1</em><span class="sig-paren">)</span><a class="headerlink" href="#mff.models.twobody.TwoBodySingleSpeciesModel.predict" title="Permalink to this definition">¶</a></dt>
<dd><p>Predict the forces acting on the central atoms of confs using a GP</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>confs</strong> (<em>list</em>) – List of M x 5 arrays containing coordinates and
atomic numbers of atoms within a cutoff from the central one</p></li>
<li><p><strong>return_std</strong> (<em>bool</em>) – if True, returns the standard deviation
associated to predictions according to the GP framework</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><p>array of force vectors predicted by the GP
forces_errors (array): errors associated to the force predictions,</p>
<blockquote>
<div><p>returned only if return_std is True</p>
</div></blockquote>
</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>forces (array)</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="mff.models.twobody.TwoBodySingleSpeciesModel.predict_energy">
<code class="sig-name descname">predict_energy</code><span class="sig-paren">(</span><em class="sig-param">glob_confs</em>, <em class="sig-param">return_std=False</em>, <em class="sig-param">ncores=1</em><span class="sig-paren">)</span><a class="headerlink" href="#mff.models.twobody.TwoBodySingleSpeciesModel.predict_energy" title="Permalink to this definition">¶</a></dt>
<dd><p>Predict the global energies of the central atoms of confs using a GP</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>glob_confs</strong> (<em>list of lists</em>) – List of configurations arranged so that
grouped configurations belong to the same snapshot</p></li>
<li><p><strong>return_std</strong> (<em>bool</em>) – if True, returns the standard deviation
associated to predictions according to the GP framework</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><p>Array containing the total energy of each snapshot
energies_errors (array): errors associated to the energies predictions,</p>
<blockquote>
<div><p>returned only if return_std is True</p>
</div></blockquote>
</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>energies (array)</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="mff.models.twobody.TwoBodySingleSpeciesModel.save">
<code class="sig-name descname">save</code><span class="sig-paren">(</span><em class="sig-param">path</em><span class="sig-paren">)</span><a class="headerlink" href="#mff.models.twobody.TwoBodySingleSpeciesModel.save" title="Permalink to this definition">¶</a></dt>
<dd><p>Save the model.
This creates a .json file containing the parameters of the model and the
paths to the GP objects and the mapped potential, which are saved as
separate .gpy and .gpz files, respectively.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>path</strong> (<em>str</em>) – path to the file</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="mff.models.twobody.TwoBodySingleSpeciesModel.save_gp">
<code class="sig-name descname">save_gp</code><span class="sig-paren">(</span><em class="sig-param">filename</em><span class="sig-paren">)</span><a class="headerlink" href="#mff.models.twobody.TwoBodySingleSpeciesModel.save_gp" title="Permalink to this definition">¶</a></dt>
<dd><p>Saves the GP object, now obsolete</p>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="three-body-model">
<h2>Three Body Model<a class="headerlink" href="#three-body-model" title="Permalink to this headline">¶</a></h2>
<p>Module containing the ThreeBodySingleSpecies and
ThreeBodyTwoSpecies classes, which are used to handle the Gaussian
process regression and the mapping algorithm used to build M-FFs.
The model has to be first defined, then the Gaussian process must be
trained using training configurations and forces (and/or local energies).
Once a model has been trained, it can be used to predict forces
(and/or energies) on unknonwn atomic configurations.
A trained Gaussian process can then be mapped onto a tabulated 3-body
potential via the <code class="docutils literal notranslate"><span class="pre">build</span> <span class="pre">grid</span></code> function call. A mapped model can be then
saved, loaded and used to run molecular dynamics simulations via the
calculator module.
These mapped potentials retain the accuracy of the GP used to build them,
while speeding up the calculations by a factor of 10^4 in typical scenarios.</p>
<p>Example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">mff</span> <span class="k">import</span> <span class="n">models</span>
<span class="n">mymodel</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">ThreeBodySingleSpecies</span><span class="p">(</span><span class="n">atomic_number</span><span class="p">,</span> <span class="n">cutoff_radius</span><span class="p">,</span> <span class="n">sigma</span><span class="p">,</span> <span class="n">theta</span><span class="p">,</span> <span class="n">noise</span><span class="p">)</span>
<span class="n">mymodel</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">training_confs</span><span class="p">,</span> <span class="n">training_forces</span><span class="p">,</span> <span class="n">ncores</span><span class="p">)</span>
<span class="n">forces</span> <span class="o">=</span> <span class="n">mymodel</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">test_configurations</span><span class="p">,</span> <span class="n">ncores</span><span class="p">)</span>
<span class="n">mymodel</span><span class="o">.</span><span class="n">build_grid</span><span class="p">(</span><span class="n">grid_start</span><span class="p">,</span> <span class="n">num_3b</span><span class="p">,</span> <span class="n">ncores</span><span class="p">)</span>
<span class="n">mymodel</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="s2">&quot;thismodel.json&quot;</span><span class="p">)</span>
<span class="n">mymodel</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">CombinedSingleSpecies</span><span class="o">.</span><span class="n">from_json</span><span class="p">(</span><span class="s2">&quot;thismodel.json&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="combined-model">
<h2>Combined Model<a class="headerlink" href="#combined-model" title="Permalink to this headline">¶</a></h2>
<p>Module that uses 2- and 3-body kernels to do Guassian process regression,
and to build 2- and 3-body mapped potentials.
The model has to be first defined, then the Gaussian processes must be
trained using training configurations and forces (and/or energies).
Once a model has been trained, it can be used to predict forces
(and/or energies) on unknonwn atomic configurations.
A trained Gaussian process can then be mapped onto a tabulated 2-body
potential  and a tabultaed 3-body potential via the <code class="docutils literal notranslate"><span class="pre">build</span> <span class="pre">grid</span></code> function call.
A mapped model can be thensaved, loaded and used to run molecular
dynamics simulations via the calculator module.
These mapped potentials retain the accuracy of the GP used to build them,
while speeding up the calculations by a factor of 10^4 in typical scenarios.</p>
<p>Example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">mff</span> <span class="k">import</span> <span class="n">models</span>
<span class="n">mymodel</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">CombinedSingleSpecies</span><span class="p">(</span><span class="n">atomic_number</span><span class="p">,</span> <span class="n">cutoff_radius</span><span class="p">,</span>
                       <span class="n">sigma_2b</span><span class="p">,</span> <span class="n">sigma_3b</span><span class="p">,</span> <span class="n">sigma_2b</span><span class="p">,</span> <span class="n">theta_3b</span><span class="p">,</span> <span class="n">noise</span><span class="p">)</span>
<span class="n">mymodel</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">training_confs</span><span class="p">,</span> <span class="n">training_forces</span><span class="p">,</span> <span class="n">ncores</span><span class="p">)</span>
<span class="n">forces</span> <span class="o">=</span> <span class="n">mymodel</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">test_configurations</span><span class="p">,</span> <span class="n">ncores</span><span class="p">)</span>
<span class="n">mymodel</span><span class="o">.</span><span class="n">build_grid</span><span class="p">(</span><span class="n">grid_start</span><span class="p">,</span> <span class="n">num_2b</span><span class="p">,</span> <span class="n">ncores</span><span class="p">)</span>
<span class="n">mymodel</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="s2">&quot;thismodel.json&quot;</span><span class="p">)</span>
<span class="n">mymodel</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">CombinedSingleSpecies</span><span class="o">.</span><span class="n">from_json</span><span class="p">(</span><span class="s2">&quot;thismodel.json&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="eam-model">
<h2>Eam Model<a class="headerlink" href="#eam-model" title="Permalink to this headline">¶</a></h2>
<p>Module that uses an eam-like many-body kernel to do Guassian process regression,
and to build eam mapped potentials.
The model has to be first defined, then the Gaussian processes must be
trained using training configurations and forces (and/or energies).
Once a model has been trained, it can be used to predict forces
(and/or energies) on unknonwn atomic configurations.
A trained Gaussian process can then be mapped onto a tabulated eam
potential via the <code class="docutils literal notranslate"><span class="pre">build</span> <span class="pre">grid</span></code> function call.
A mapped model can be thensaved, loaded and used to run molecular
dynamics simulations via the calculator module.
These mapped potentials retain the accuracy of the GP used to build them,
while speeding up the calculations by a factor of 10^4 in typical scenarios.</p>
<p>Example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">mff</span> <span class="k">import</span> <span class="n">models</span>
<span class="n">mymodel</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">EamSingleSpecies</span><span class="p">(</span><span class="n">atomic_number</span><span class="p">,</span> <span class="n">cutoff_radius</span><span class="p">,</span>
                        <span class="n">sigma</span><span class="p">,</span> <span class="n">alpha</span><span class="p">,</span> <span class="n">r0</span><span class="p">,</span> <span class="n">noise</span><span class="p">)</span>
<span class="n">mymodel</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">training_confs</span><span class="p">,</span> <span class="n">training_forces</span><span class="p">,</span> <span class="n">ncores</span><span class="p">)</span>
<span class="n">forces</span> <span class="o">=</span> <span class="n">mymodel</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">test_configurations</span><span class="p">,</span> <span class="n">ncores</span><span class="p">)</span>
<span class="n">mymodel</span><span class="o">.</span><span class="n">build_grid</span><span class="p">(</span><span class="n">grid_start</span><span class="p">,</span> <span class="n">num_2b</span><span class="p">,</span> <span class="n">ncores</span><span class="p">)</span>
<span class="n">mymodel</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="s2">&quot;thismodel.json&quot;</span><span class="p">)</span>
<span class="n">mymodel</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">EamSingleSpecies</span><span class="o">.</span><span class="n">from_json</span><span class="p">(</span><span class="s2">&quot;thismodel.json&quot;</span><span class="p">)</span>
</pre></div>
</div>
<hr class="docutils" />
<p>Module that uses a 2+3+many-body kernel to do Guassian process regression,
and to build eam mapped potentials.
The model has to be first defined, then the Gaussian processes must be
trained using training configurations and forces (and/or energies).
Once a model has been trained, it can be used to predict forces
(and/or energies) on unknonwn atomic configurations.
A trained Gaussian process can then be mapped onto tabulated 2, 3 and eam
potentials via the <code class="docutils literal notranslate"><span class="pre">build</span> <span class="pre">grid</span></code> function call.
A mapped model can be thensaved, loaded and used to run molecular
dynamics simulations via the calculator module.
These mapped potentials retain the accuracy of the GP used to build them,
while speeding up the calculations by a factor of 10^4 in typical scenarios.</p>
<p>Example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">mff</span> <span class="k">import</span> <span class="n">models</span>
<span class="n">mymodel</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">TwoThreeEamSingleSpecies</span><span class="p">(</span><span class="n">atomic_number</span><span class="p">,</span> <span class="n">cutoff_radius</span><span class="p">,</span> <span class="n">sigma_2b</span><span class="p">,</span> <span class="n">sigma_3b</span><span class="p">,</span>
                               <span class="n">sigma_eam</span><span class="p">,</span> <span class="n">theta_2b</span><span class="p">,</span> <span class="n">theta_3b</span><span class="p">,</span> <span class="n">alpha</span><span class="p">,</span> <span class="n">r0</span><span class="p">,</span> <span class="n">noise</span><span class="p">,</span> <span class="n">rep_sig</span><span class="p">)</span>
<span class="n">mymodel</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">training_confs</span><span class="p">,</span> <span class="n">training_forces</span><span class="p">,</span> <span class="n">ncores</span><span class="p">)</span>
<span class="n">forces</span> <span class="o">=</span> <span class="n">mymodel</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">test_configurations</span><span class="p">,</span> <span class="n">ncores</span><span class="p">)</span>
<span class="n">mymodel</span><span class="o">.</span><span class="n">build_grid</span><span class="p">(</span><span class="n">start</span><span class="p">,</span> <span class="n">start_eam</span><span class="p">,</span> <span class="n">end_eam</span><span class="p">,</span> <span class="n">num_2b</span><span class="p">,</span> <span class="n">num_3b</span><span class="p">,</span> <span class="n">num_eam</span><span class="p">,</span> <span class="n">ncores</span><span class="p">)</span>
<span class="n">mymodel</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="s2">&quot;thismodel.json&quot;</span><span class="p">)</span>
<span class="n">mymodel</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">EamSingleSpecies</span><span class="o">.</span><span class="n">from_json</span><span class="p">(</span><span class="s2">&quot;thismodel.json&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="confs.html" class="btn btn-neutral float-right" title="Configurations" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="install.html" class="btn btn-neutral float-left" title="Installation" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>

    </p>
  </div> 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>